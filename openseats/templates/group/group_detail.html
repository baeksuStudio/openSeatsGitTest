
{% extends 'basic/base.html' %}
{% block title %}Openseats - {{group.name}}{% endblock %}

{% block content %}

<style>
  .group-container {
    padding: 0 30px;
    margin-top: 50px;
  }

  .group-title {
    margin-bottom: 20px;
    font-size: 35px;
  } 
  .group-title > h1 {
    font-weight: bold;
    font-size: 40px;
  }

  .carousel-container {
    max-width: 701px;
    max-height: 500px !important;

  }
  .carousel-img{
    width: 550px;
    height: 400px;
    max-width: 700px;
    background-size: cover;
    background-position: center center;
    margin: 0;
    padding: 0;
  }

.stats{

      background: #f2f5f8 !important;

    color: #000 !important;
}
.articles{
  font-size:10px;
  color: #a1aab9;
}
.number1{
  font-weight:500;
}
.followers{
    font-size:10px;
  color: #a1aab9;

}
.number2{
  font-weight:500;
}
.rating{
    font-size:10px;
  color: #a1aab9;
}
.number3{
  font-weight:500;
}
</style>


<div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">가입신청</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
           <div class="form-group">
            <label for="recipient-name" class="col-form-label">제목:</label>
            <input type="text" class="form-control" id="recipient-name">
          </div>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">가입신청 메세지:</label>
            <textarea class="form-control" id="message-text" style="height: 100px;"></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
        <button type="button" class="btn btn-primary">가입신청</button>
      </div>
    </div>
  </div>
</div>

<div class="container group-container">
  <div class="row">
    {%  include 'basic/flash.html' %}
  </div>
	<div class="row justify-conetnet-center">
		<div class="col-md-5">
			<div class="page-header group-title">
				<h1>
                    <!-- Group 타이틀 -->
					{{ group.name }}
				</h1>
      <div class="d-flex" style="margin-left: 3px; color: #5e5e5e">
        <h6 class="fw-bold mt-1">{{ group.address }}</h6>
      </div>
			</div>
		</div>
		<div class="col-md-3">
		</div>
	</div>
	<div class="row mb-7 ">
		<div class="col-md-7">
			<!-- carousel 시작 -->
      {% if group.images %}
            <div id="carouselExampleIndicators" class="carousel slide carousel-container mb-3" data-interval="false">
                <div class="carousel-indicators">
                <button
                    type="button"
                    data-bs-target="#carouselExampleIndicators"
                    data-bs-slide-to="0"
                    class="active"
                    aria-current="true"
                    aria-label="Slide 1"
                ></button>
                {% for i in range(group.images|length) %} {% if i != 0%}
                <button
                    type="button"
                    data-bs-target="#carouselExampleIndicators"
                    data-bs-slide-to="{{i}}"
                    aria-label="Slide {{i}}"
                ></button>
                {% endif %} {% endfor %}
                </div>
                <div class="carousel-inner">
                <div class="carousel-item active">
                    <img
                    src="{{ url_for('static', filename='/uploads/img/{}/{}'.format(group.id ,group.images[0].name)) }}"
                    class="d-block w-100 carousel-img"
                    alt="..."
                    />
                </div>
                {% for i in range(group.images|length) %} {% if i != 0%}
                <div class="carousel-item">
                    <img
                    src="{{ url_for('static', filename='/uploads/img/{}/{}'.format(group.id, group.images[i].name)) }}"
                    class="d-block w-100 carousel-img"
                    alt="..."
                    />
                </div>
                {% endif %} {% endfor %}
                </div>
                {% if group.images|length > 1 %}
                <button
                class="carousel-control-prev"
                type="button"
                data-bs-target="#carouselExampleIndicators"
                data-bs-slide="prev"
                >
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
                </button>
                <button
                class="carousel-control-next"
                type="button"
                data-bs-target="#carouselExampleIndicators"
                data-bs-slide="next"
                >
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
                </button>
                {% endif %}
            </div>
      {% else %}
            <div style="background-color: #dedede; width: 650px;" class="carousel-img d-flex justify-content-center align-items-center">
              <div>이미지 없음</div>
            </div>
      {% endif %}
      <!-- carousel 끝 -->
		</div>
		<div class="col-md-5 " style="width: 350px;">
            <div class="div">
                <!-- 첫번째, 호스트 프로필 -->
                <div class="owner container d-flex justify-content-center px-0 border-bottom mb-3 pt-3" id="redirect_user_page onclick="redirect_user_page()" data-uri="{{ url_for('main.my_page', username=group.owner.userID) }}" style="margin-left: 0px">
                    <div class="image">
                      <img src="{{ url_for('feature.get_profile_image', user_id=group.owner.id) }}" class="rounded-circle mx-auto d-block mb-3" alt="프로필 사진" width="60" height="60">
                    </div>
                    <div class="ml-3 w-100" style="margin-left: 10px;">
                      <span class="mb-2">이 그룹의 호스트</span>
                      <!-- <span>{{ group.owner.email }}</span> -->
                      <h5 class="mt-1"><a class="a" href="{{ url_for('main.my_page', username=group.owner.userID) }}">{{ group.owner.username }}</a></h5>
                    </div>
                </div> 
                <!-- 두번째, 좋아요 -->
                <div class="d-flex justify-content-between pb-2 mb-1">
                  <div>
                      <h3 class="" style="font-size: 20px;">
                        좋아요
                      </h3>
                  </div>
                  <div>
                      <h3 class="" style="font-size: 20px;">
                        1403개
                      </h3>
                  </div>
                </div>
                <!-- 세번째, 후기 -->
                <div class="d-flex justify-content-between border-bottom pb-2 mb-3">
                  <div>
                      <h3 class="" style="font-size: 20px;">
                        후기
                      </h3>
                  </div>
                  <div>
                      <h3 class="" style="font-size: 20px;">
                        ★4.96 (126개)
                      </h3>
                  </div>
                </div>
   
                <!-- 네번쨰 -->
                <div class="d-flex justify-content-between border-bottom pb-2 mb-3 collapse-btn" style="cursor: pointer">
                  <div>
                      <h3 class="" style="font-size: 20px;">
                        그룹 멤버
                      </h3>
                  </div>
                  <div class="d-flex">
                      <h3 class="mx-2" style="font-size: 20px;">
                       {{ group.reservation|length }}명
                      </h3>
                  </div>
                </div>
                <!-- 그룹 멤버 collapse -->
                <!-- toggle guider -->
                <!-- https://stackoverflow.com/questions/16224636/twitter-bootstrap-collapse-change-display-of-toggle-button -->
                <div class="collapse" id="collapse">
                  {% for i in range(0, group.reservation|length) %}
                  {% if i == group.reservation|length - 1 %}
                  <div class="d-flex border-bottom pb-2 mb-3">
                  {% else %}
                  <div class="d-flex pb-2 mb-1">
                  {% endif %}
                    <div>
                        <img src="{{ url_for('feature.get_profile_image', user_id=group.reservation[i].user.id) }}" class="rounded-circle d-block mb-2" style="margin-right: 3px" alt="프로필 사진" width="30" height="30">
                    </div>
                    <div class="d-flex">
                        <a class="a" class="fw-bold" href="{{ url_for('main.my_page', username=group.reservation[i].user.userID)}}">
                          <h3 class="mx-2" style="font-size: 20px;">{{group.reservation[i].user.username}}</h3>
                        </a>
                    </div>
                  </div>
                  {% endfor %}
                </div>
                <!-- <div class="card" style="width: 18rem; margin-bottom: 10px;">
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                      <h3 class="fw-bold" style="font-size: 20px;">
                        그룹 멤버 ({{ group.reservation|length }}명)
                      </h3>
                    </li>
                    {% for i in range(0, group.reservation|length) %}
                      <li class="list-group-item d-flex my-1">
                        <img src="{{ url_for('feature.get_profile_image', user_id=group.reservation[i].user.id) }}" class="rounded-circle d-block mb-3" style="margin-right: 7px" alt="프로필 사진" width="30" height="30">
                        <a class="a" class="fw-bold" href="{{ url_for('main.my_page', username=group.reservation[i].user.userID)}}">{{group.reservation[i].user.username}}</a>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              <!- 예약하기 버튼 -->
            <form method="POST" action="{{ url_for('group.join', group_id=group.id, user_id=g.user.id) }}">
              {% if join_status == 'already joined' %}
              <input class="btn btn-primary" type="submit" value="이미 가입되어 있습니다." style="width: 100%" disabled>
              {% elif join_status == 'not joined' %}
              <!-- <input class="btn btn-primary" type="submit" value="가입신청"> -->
              <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal" id="myInput" style="width: 100%">가입신청</button>

              {% elif join_status == 'owner' %}
              <input class="btn btn-primary" type="submit" style="width: 100%" value="이 그룹의 소유자 입니다." disabled>
              {% endif %}
            </form>
            </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-7">
      <h2>그룹 설명</h2>
      <p>{{ group.description }}</p>
    </div>
    <div class="col-md-5">
    </div>
  </div>
</div>

<script>
  $('.collapse-btn').click(function(){ //you can give id or class name here for $('button')
    const bsCollapse = new bootstrap.Collapse('#collapse', {
    toggle: false
    })
    bsCollapse.toggle()
});
</script>
{% endblock %}